# Para clasificarlos
points(nuevos_datos[1, ], col="green", pch=11) # primer animal
points(nuevos_datos[2, ], col="red", pch=11) # segundo animal
points(nuevos_datos[3, ], col="pink", pch=11) # tercer animal
#### Ahora vamos a predecir ####
predict(modelo_svm, newdata = nuevos_datos)
# Regeneramos grafica para actualizar los margenes x e y
# para poder visualizar los nuevos datos
plot(datos[ ,c(1,2)], col=datos$animal,
pch=19,
xlim=c(0, 180),
ylim=C(80,200))
# Regeneramos grafica para actualizar los margenes x e y
# para poder visualizar los nuevos datos
plot(datos[ ,c(1,2)], col=datos$animal,
pch=19,
xlim=c(0, 180),
ylim=c(80,200))
abline(a= -b/w[1,2], b= -w[1,1]/w[1,2], col="green",
lty=2)
# Vamos a agregar a la grafica los nuevos datos
# Para clasificarlos
points(nuevos_datos[1, ], col="green", pch=11) # primer animal
points(nuevos_datos[2, ], col="red", pch=11) # segundo animal
points(nuevos_datos[3, ], col="pink", pch=11) # tercer animal
#### Ahora vamos a predecir ####
predict(modelo_svm, newdata = nuevos_datos)
abline(a = -b/w[1, 2], b = -w[1, 1]/w[1, 2],
col = "green", lty = 2)
# Crear un modelo de SVR para los datos del Titanic
table(datos$animal)
datos <- read.delim("D:/MCPI/Análisis_De_Datos/AnalisisDeDatos_Project/Datasets/caballos.txt", stringsAsFactors=TRUE)
# Para SVM la calse debe ser factor
class(datos$animal)
# Vamos a convertir la columna de "animal" de entero a FACTOR
datos$animal <- as.factor(datos$animal)
class(datos$animal)
# Mostramos los datos solo como visualizacion
plot(datos[ , c(1,2)], col=datos$animal, pch=19)
# Vamos a crear el modelo SVM
library(e1071)
# modelo
modelo_svm <- svm(animal ~ Height + Weight, data = datos,
type="C-classification",
kernel="linear",
scale = FALSE)
summary(modelo_svm)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos[modelo_svm$index, c(1,2)], col="green", cex=3, lwd=2)
# Dibujar el hiperplano (enalogo a los betas de una reg)
w <- t(modelo_svm$coefs)%*%modelo_svm$SV
b <- (modelo_svm$rho)
###
abline(a= -b/w[1,2], b= -w[1,1]/w[1,2], col="green",
lty=2)
### Terminamos la parte didactica
### Vamos a probar con nuevos datos
nuevos_datos <- data.frame(Height=c(67, 120, 100),
Weight=c(100, 190, 100)
)
# Regeneramos grafica para actualizar los margenes x e y
# para poder visualizar los nuevos datos
plot(datos[ ,c(1,2)], col=datos$animal,
pch=19,
xlim=c(0, 180),
ylim=c(80,200))
abline(a = -b/w[1, 2], b = -w[1, 1]/w[1, 2],
col = "green", lty = 2)
# Vamos a agregar a la grafica los nuevos datos
# Para clasificarlos
points(nuevos_datos[1, ], col="green", pch=11) # primer animal
points(nuevos_datos[2, ], col="red", pch=11) # segundo animal
points(nuevos_datos[3, ], col="pink", pch=11) # tercer animal
#### Ahora vamos a predecir ####
predict(modelo_svm, newdata = nuevos_datos)
# Crear un modelo de SVR para los datos del Titanic
abline(a = -b/w[1, 2], b = -w[1, 1]/w[1, 2],
col = "green", lty = 2)
library(e1071)
Datos <- read.csv("D:/MCPI/Análisis_De_Datos/AnalisisDeDatos_Project/Datasets/DatosTitanic_SinLimpiar.csv", stringsAsFactors=TRUE)
View(Datos)
# Carga los datos
datos <- read.csv("D:/MCPI/Análisis_De_Datos/AnalisisDeDatos_Project/Datasets/DatosTitanic_SinLimpiar.csv", stringsAsFactors=TRUE)
datos
datos_limpios <- datos[!is.na(datos$Edad), ]
class(datos_limpios)
class(datos_limpios$Vivio)
# Convertir la variable vivios a Factor
datos_limpios$Vivio <- as.factor(datos_limpios$Vivio)
class(datos_limpios$Vivio)
# Mostramos los datos solo como visualizacion
plot(datos[ , c(1,2)], col=datos_limpios$Vivio, pch=19)
# modelo SVR
modelo_svr <- svm(Vivio ~ Sexo + Edad, data = datos_limpios,
type="C-classification",
kernel="linear",
scale = FALSE)
summary(modelo_svm)
summary(modelo_svr)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos_limpios[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
# Mostramos los datos solo como visualizacion
plot(datos[ , c(1,2)], col=datos_limpios$Vivio, pch=19)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos_limpios[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
# Dibujar el hiperplano (enalogo a los betas de una reg)
w <- t(modelo_svr$coefs)%*%modelo_svr$SV
b <- (modelo_svr$rho)
###
abline(a= -b/w[1,2], b= -w[1,1]/w[1,2], col="green",
lty=2)
# modelo SVR
modelo_svr <- svm(Vivio ~ Sexo + Edad, data = datos_limpios,
type="C-classification",
kernel="polynomial",
scale = FALSE)
summary(modelo_svr)
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos_limpios[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
# Dibujar el hiperplano (enalogo a los betas de una reg)
w <- t(modelo_svr$coefs)%*%modelo_svr$SV
b <- (modelo_svr$rho)
###
abline(a= -b/w[1,2], b= -w[1,1]/w[1,2], col="green",
lty=2)
# Para SVM la calse debe ser factor
class(datos$animal)
class(datos_limpios$Vivio) # Integer
titanic_data$Sex <- as.factor(titanic_data$Sex)
datos_limpios$Sex <- as.factor(datos_limpios$Sex)
View(datos_limpios)
# Carga los datos
datos <- read.csv("D:/MCPI/Análisis_De_Datos/AnalisisDeDatos_Project/Datasets/DatosTitanic_SinLimpiar.csv", stringsAsFactors=TRUE)
# Limpia los datos quitar NA´s
datos_limpios <- datos[!is.na(datos$Edad), ]
class(datos_limpios$Vivio) # Integer
# Convertir la variable vivios a Factor
datos_limpios$Vivio <- as.factor(datos_limpios$Vivio)
class(datos_limpios$Vivio)
datos_limpios$Sexo <- as.factor(datos_limpios$Sexo)
class(datos_limpios$s)
datos_limpios$Sexo <- as.factor(datos_limpios$Sexo)
class(datos_limpios$Sexo)
View(datos)
View(datos_limpios)
# Mostramos los datos solo como visualizacion
plot(datos[ , c(1,2)], col=datos_limpios$Sexo, pch=19)
# Mostramos los datos solo como visualizacion
plot(datos_limpios[ , c(1,2)], col=datos_limpios$Sexo, pch=19)
datos_limpios$Sexo <- as.factor(datos_limpios$Sexo)
# Mostramos los datos solo como visualizacion
plot(datos_limpios[ , c(1,2)], col=datos_limpios$Sexo, pch=19)
# modelo SVR
# Establecer una semilla para reproducibilidad
set.seed(123)
# Dividir los datos (80% para entrenamiento, 20% para prueba)
train_indices <- sample(1:nrow(datos_limpios), 0.8 * nrow(datos_limpios))
training_set <- datos_limpios[train_indices, ]
test_set <- datos_limpios[-train_indices, ]
modelo_svr <- svm(Vivio ~ Sexo + Edad, data = datos_limpios,
type="C-classification",
kernel="radial",
scale = FALSE)
summary(modelo_svr)
# Predecir sobre el conjunto de prueba
predicciones_svm <- predict(modelo_svm, test_set)
modelo_svm <- svm(Vivio ~ Sexo + Edad, data = datos_limpios,
type="C-classification",
kernel="radial",
scale = FALSE)
summary(modelo_svr)
summary(modelo_svm)
# Predecir sobre el conjunto de prueba
predicciones_svm <- predict(modelo_svm, test_set)
# Crear una matriz de confusión para evaluar el rendimiento
matriz_confusion <- table(predicciones_svm, test_set$Survived)
# Crear una matriz de confusión para evaluar el rendimiento
matriz_confusion <- table(predicciones_svm, test_set$Vivio)
print(matriz_confusion)
# Calcular la precisión
precision <- sum(diag(matriz_confusion)) / sum(matriz_confusion)
print(paste("Precisión del modelo:", round(precision * 100, 2), "%"))
## 100% Didactico #####
# Donde estan los soportes (Soft margins)?
points(datos_limpios[modelo_svr$index, c(1,2)], col="green", cex=3, lwd=2)
# Dibujar el hiperplano (enalogo a los betas de una reg)
w <- t(modelo_svr$coefs)%*%modelo_svr$SV
b <- (modelo_svr$rho)
###
abline(a= -b/w[1,2], b= -w[1,1]/w[1,2], col="green",
lty=2)
# Cargar los datos
prestamos <- read.csv("D:/MCPI/Análisis_De_Datos/AnalisisDeDatos_Project/Datasets/loan_data.csv", stringsAsFactors=TRUE)
# Vamos a checar los NA´S con librerias
library(naniar)
vis_miss(prestamos) # tenemos el 100% de los datos
# Vamos a crear el modelo SVM
library(e1071)
### Muestra del 10%
library(caret)
datos_muestra <- createDataPartition(
y = prestamos$loan_status,
p = 0.1,
list = FALSE
)
datosEntrenaminto <- prestamos[datos_muestra, ]
View(datos_muestra)
View(datos_muestra)
View(prestamos)
datos_muestra <- createDataPartition(
y = prestamos$loan_status,
p = 0.1,
list = FALSE
)
datosEntrenaminto <- prestamos[ datos_muestra, ]
# modelo
modelo_a <- svm(loan_status ~ credit_score + person_age + person_income,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
summary(modelo_a)
className(prestamos)
className(prestamos)
colnames(prestamos)
# modelo b
modelo_b <- svm(loan_status ~ credit_score + person_age + person_income + person_gender,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
summary(modelo_b)
#### Predicciones modelo a
predicciones_a <- predict(modelo_a, newdata = datosEntrenaminto)
#### Predicciones modelo b
predicciones_b <- predict(modelo_b, newdata = datosEntrenaminto)
# Crear las tablitas para obtener la curva ROC
tablita_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = predicciones_a)
View(tablita_a)
# Crear las tablitas para obtener la curva ROC
tablita_b <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = predicciones_b)
#### Curvas ROC
library(pROC)
predicciones_a
#### Calcular Curva ROC modelo a
mi_curva <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', main="Modelo A: Grafica ROC")
# Crear las tablitas para obtener la curva ROC
tablita_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_a)-1)
tablita_b <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_b)-1)
#### Curvas ROC
library(pROC)
#### Calcular Curva ROC modelo a
mi_curva <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', main="Modelo A: Grafica ROC")
### Area bajo la curva
mi_curva$auc
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', main="Modelo A: Grafica ROC")
### Area bajo la curva
mi_curva_a$auc
#### Calcular Curva ROC modelo b
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', main="Modelo B: Grafica ROC")
### Area bajo la curva
mi_curva_b$auc
### Area bajo la curva
mi_curva_a$auc
### Area bajo la curva
mi_curva_b$auc
#### Calcular Curva ROC modelo b
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main="Modelo B: Grafica ROC")
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main="Modelo A: Grafica ROC")
#### Calcular Curva ROC modelo b
par(new=TRUE)
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main="Modelo B: Grafica ROC")
#### Crear modelos de regresion logistica
modelo_rl_a <- glm(loan_status ~ credit_score + person_age +
person_income + person_gender,
data = datosEntrenaminto,
family= "binomial",
)
summary(modelo_rl_a)
# Creamos la tabla
tablita_rl_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_a)-1)
#### Predicciones del modelo a de regresion logistica
predicciones_a <- predict(modelo_rl_a, newdata = datosEntrenaminto,type = "response")
# Creamos la tabla
tablita_rl_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_a)-1)
#### Predicciones del modelo a de regresion logistica
predicciones_rl_a <- predict(modelo_rl_a, newdata = datosEntrenaminto,type = "response")
# Creamos la tabla
tablita_rl_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_rl_a)-1)
#### Calcular Curva ROC modelo a
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="Modelo A: Grafica ROC")
### Area bajo la curva
mi_curva_rl_a$auc
#### Calcular Curva ROC modelo a
par(new=TRUE)
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="Modelo A: Grafica ROC")
# modelo a
modelo_a <- svm(loan_status ~ credit_score + person_age + person_income,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
# modelo b
modelo_b <- svm(loan_status ~ credit_score + person_age + person_income + person_gender,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
#### Predicciones modelo a
predicciones_a <- predict(modelo_a, newdata = datosEntrenaminto)
#### Predicciones modelo b
predicciones_b <- predict(modelo_b, newdata = datosEntrenaminto)
# Crear las tablitas para obtener la curva ROC
tablita_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_a)-1)
tablita_b <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_b)-1)
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main="Modelo A: Grafica ROC")
### Area bajo la curva
mi_curva_a$auc
#### Calcular Curva ROC modelo b
par(new=TRUE)
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main="Modelo B: Grafica ROC")
#### Crear modelos de regresion logistica
modelo_rl_a <- glm(loan_status ~ credit_score + person_age +
person_income + person_gender,
data = datosEntrenaminto,
family= "binomial",
)
#### Predicciones del modelo a de regresion logistica
predicciones_rl_a <- predict(modelo_rl_a, newdata = datosEntrenaminto,type = "response")
#### Crear modelos de regresion logistica
modelo_rl_a <- glm(loan_status ~ credit_score + person_age +
person_income + person_gender,
data = datosEntrenaminto,
family= "binomial",
)
#### Predicciones del modelo a de regresion logistica
predicciones_rl_a <- predict(modelo_rl_a, newdata = datosEntrenaminto,type = "response")
# Creamos la tabla
tablita_rl_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_rl_a)-1)
#### Calcular Curva ROC modelo a
par(new=TRUE)
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="Modelo A: Grafica ROC")
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="")
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main="Modelo A: Grafica ROC")
#### Calcular Curva ROC modelo b
par(new=TRUE)
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main=" ")
#### Calcular Curva ROC modelo b
par(new=TRUE)
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main=" ")
#### Calcular Curva ROC modelo a
par(new=TRUE)
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="")
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main=" ")
#### Calcular Curva ROC modelo b
par(new=TRUE)
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main=" ")
#### Calcular Curva ROC modelo a
par(new=TRUE)
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="")
#### Nuevos Modelos sin credit score
# modelo a
modelo_a_2 <- svm(loan_status ~ + person_age + person_income,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
# modelo b
modelo_b_2 <- svm(loan_status ~ credit_score + person_age + person_income + person_gender,
data = datosEntrenaminto,
type="C-classification",
kernel="radial",
scale = FALSE)
# Modelo de regresion logistica
modelo_rl_a_2 <- glm(loan_status ~ + person_age +
person_income + person_gender,
data = datosEntrenaminto,
family= "binomial",
)
# Predicciones y tablitas
#### Predicciones modelo a
predicciones_a <- predict(modelo_a, newdata = datosEntrenaminto)
# Predicciones y tablitas
#### Predicciones modelo a
predicciones_a <- predict(modelo_a_2, newdata = datosEntrenaminto)
#### Predicciones modelo b
predicciones_b <- predict(modelo_b_2, newdata = datosEntrenaminto)
# Crear las tablitas para obtener la curva ROC
tablita_a <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_a)-1)
tablita_b <- data.frame(Original = datosEntrenaminto$loan_status,
Predicciones = as.numeric(predicciones_b)-1)
# Modelo Regresion logistica
par(new=TRUE)
### Curvas ROC
#### Calcular Curva ROC modelo a
mi_curva_a <- roc(tablita_a$Original, tablita_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='blue', main=" ")
#### Calcular Curva ROC modelo b
par(new=TRUE)
mi_curva_b <- roc(tablita_b$Original, tablita_b$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='red', lty=3,
main=" ")
# Modelo Regresion logistica
par(new=TRUE)
mi_curva_rl_a <- roc(tablita_a$Original, tablita_rl_a$Predicciones,
levels=c(0,1), plot=TRUE, ci=TRUE,
smooth=FALSE, direction='auto',
col='green', main="")
### Area bajo la curva
mi_curva_rl_a$auc
mi_curva_b$auc
mi_curva_rl_a$auc
### Area bajo la curva
mi_curva_a$auc
mi_curva_b$auc
mi_curva_rl_a$auc
