# Histogramas
hist(AO, breaks = 15)
hist(AA, breaks = 15)
# Cuarto momento (Curtosis)
kurtosis(AO) # -> Negativa -0.5527793
kurtosis(AA) # -> Positiva 1.193106
# Funcion
plotn <- function(x,main="Histograma de frecuencias \ny distribución normal",
xlab="X",ylab="Densidad") {
min <- min(x)
max <- max(x)
media <- mean(x)
dt <- sd(x)
hist(x,freq=F,main=main,xlab=xlab,ylab=ylab)
curve(dnorm(x,media,dt), min, max,add = T,col="red") # Genera una curva de distribucion normal
}
plotn(AO)
plotn(AA)
#######################
#
# Correlacion
#
######################
cor.test(AO,AA) # 0.3119695
cor.test(AA, AO)
gc()
## Prueba de Shapiro-Wilk (Se usa en muestras pequeñas < 50 muestras)
shapiro.test(AO)
shapiro.test(AA)
shapiro.test(AA) #
## Prueba de Shapiro-Wilk (Se usa en muestras pequeñas < 50 muestras)
## H0 (Hipotesis Nula): los datos siguen una distribucion normal p-valor > 5
## H1 (Hipotesis Alternativa): los datos no siguen una distribucion normal p-valor < 5
## W debe de estar ceraca de 1
shapiro.test(AO) # No es normal
shapiro.test(AA) #
plotn(AA)
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,1))
lines(AO, type = "o", col="green", pch="o")
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,1))
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,100))
lines(AO, type = "o", col="green", pch="o")
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,150))
lines(AO, type = "o", col="green", pch="o")
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(50,150))
lines(AO, type = "o", col="green", pch="o")
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,150))
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,110))
lines(AO, type = "o", col="green", pch="o")
plot(AA, type = "o", col="blue", pch = "o", lty=1,
ylim = c(0,120))
lines(AO, type = "o", col="green", pch="o")
## Correlacion de Spearman
cor.test(AO, AA, method = "sperman")
## Correlacion de Spearman
cor.test(AO, AA, method = "spearman")
install.packages("corrplot")
library(corrplot)
# Graficar
tsh = c(7.47, 2.64, -2.49, 0.31, 7.47, 6.64, 13.49, 2.64, 14.45, 7.27, 17.31, 3.45, 0.57, 7.84, 7.08,	1.25,	6.69,	0.64,	1.06)
datosA <- cbind.data.frame(AA, AO, tsh)
View(datosA)
corrplot(datosA)
corrplot(cor(datosA))
shapiro.test(tsh)
hist(tsh)
plotn(tsh)
corrplot(cor(datosA, method = "spearman"))
par(mfrow=c(1,2))
corrplot(cor(datosA, method = "spearman"))
corrplot(cor(datosA, method = "pearson"))
par(mfrow=c(1,2))
corrplot(cor(datosA, method = "spearman"), method = "pie")
pearson
corrplot(cor(datosA, method = "pearson"), method = "pie")
wdbc_unificado <- read.csv("D:/MCPI/Mineria_De_Datos/wdbc_unificado.csv", stringsAsFactors=TRUE)
View(wdbc_unificado)
# Conjunto de datos de cancer de mama CM (lesiones)
CM <- wdbc_unificado
# Funcion
plotn <- function(x,main="Histograma de frecuencias \ny distribución normal",
xlab="X",ylab="Densidad") {
min <- min(x)
max <- max(x)
media <- mean(x)
dt <- sd(x)
hist(x,freq=F,main=main,xlab=xlab,ylab=ylab)
curve(dnorm(x,media,dt), min, max,add = T,col="red") # Genera una curva de distribucion normal
}
CM <- wdbc_unificado
CM_radio <- CM$radius_mean
CM_textura <- CM$texture_mean
mean(CM_radio)
median(CM_radio)
boxplot(CM_radio)
sd(CM_radio) # 14.12 +- 3.52 -> {10.6, 17.64 (68%)}  {7 - 21 (95%)} {3.5 - 24.5 (99.7%)}
skewness(CM_radio)
library(e1071)
mean(CM_radio)
median(CM_radio)
boxplot(CM_radio)
sd(CM_radio) # 14.12 +- 3.52 -> {10.6, 17.64 (68%)}  {7 - 21 (95%)} {3.5 - 24.5 (99.7%)}
skewness(CM_radio)
kurtosis(CM_radio)
summary(CM_radio)
hist(CM_radio)
plotn(CM_radio)
shapiro.test(CM_radio [180:210])
ks.test(CM_radio, "pnorm", mean = mean(CM_radio), sd = sd(CM_radio))
qqnorm(CM_radio)
mean(CM_textura)
median(CM_textura)
boxplot(CM_textura)
summary(CM_textura)
sd(CM_textura) #19.29 +- 4.3 --- 15 - 23.6 (68%) 10.7 - 28 (95%) 6.4 - 32.3 (99.7%)
skewness(CM_textura)
kurtosis(CM_textura)
hist(CM_textura)
plotn(CM_textura)
shapiro.test(CM_radio [30:60])
ks.test(CM_textura, "pnorm", mean = mean(CM_textura), sd = sd(CM_textura))
qqnorm(CM_textura)
cor.test(CM_radio, CM_textura)
cor.test(CM_textura, CM_radio)
cor.test(CM_radio, CM_textura, method = "spearman")
corrplot(cor(CM[,3:8], method = "spearman"), "pie")
install.packages("corrplot")
# Librerias
library(corrplot)
cor.test(CM_radio, CM_textura)
cor.test(CM_textura, CM_radio)
cor.test(CM_radio, CM_textura, method = "spearman")
corrplot(cor(CM[,3:8], method = "spearman"), "pie")
corrplot(cor(CM[,3:32], method = "spearman"), "pie") # variable de la 3 a la 8
8
corrplot(cor(CM[,3:8], method = "spearman"), method= "pie") # variable de la 3 a la 8
########################
#
# Regresion Lineal
#
########################
modeloRT <- lm(CM_radio ~ CM_textura)
summary(modeloRT)
modeloRT
modeloRT
modeloRT
summary(modeloRT)
plot(CM_textura, CM_radio)
plot(CM_textura, CM_radio, pch=16, cex=1.3)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="gren")
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloRT)
####
modeloTR <- lm(CM_radio ~ CM_textura) # estimar la textura dado el radio
modeloTR
summary(modeloTR)
####
modeloTR <- lm(CM_textura ~ CM_radio) # estimar la textura dado el radio
modeloTR
summary(modeloTR)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloTR)
plot(CM_radio, CM_radio, pch=16, cex=1.3, col="green")
plot(CM_radio, CM_textura, pch=16, cex=1.3, col="green")
abline(modeloTR)
plot(CM_radio, CM_textura, pch=16, cex=1.3, col="red")
abline(modeloTR)
# Librerias
library(corrplot)
library(e1071)
# Conjunto de datos de cancer de mama CM (lesiones)
CM <- wdbc_unificado
# Funcion
plotn <- function(x,main="Histograma de frecuencias \ny distribución normal",
xlab="X",ylab="Densidad") {
min <- min(x)
max <- max(x)
media <- mean(x)
dt <- sd(x)
hist(x,freq=F,main=main,xlab=xlab,ylab=ylab)
curve(dnorm(x,media,dt), min, max,add = T,col="red") # Genera una curva de distribucion normal
}
CM <- wdbc_unificado
CM_radio <- CM$radius_mean
CM_textura <- CM$texture_mean
mean(CM_radio)
median(CM_radio)
boxplot(CM_radio)
sd(CM_radio) # 14.12 +- 3.52 -> {10.6, 17.64 (68%)}  {7 - 21 (95%)} {3.5 - 24.5 (99.7%)}
skewness(CM_radio)
kurtosis(CM_radio)
summary(CM_radio)
hist(CM_radio)
plotn(CM_radio)
shapiro.test(CM_radio [180:210])
ks.test(CM_radio, "pnorm", mean = mean(CM_radio), sd = sd(CM_radio))
qqnorm(CM_radio)
mean(CM_textura)
median(CM_textura)
boxplot(CM_textura)
summary(CM_textura)
sd(CM_textura) #19.29 +- 4.3 --- 15 - 23.6 (68%) 10.7 - 28 (95%) 6.4 - 32.3 (99.7%)
skewness(CM_textura)
kurtosis(CM_textura)
hist(CM_textura)
plotn(CM_textura)
shapiro.test(CM_radio [30:60])
ks.test(CM_textura, "pnorm", mean = mean(CM_textura), sd = sd(CM_textura))
qqnorm(CM_textura)
# Correlaciones
cor.test(CM_radio, CM_textura)
cor.test(CM_textura, CM_radio)
cor.test(CM_radio, CM_textura, method = "spearman")
corrplot(cor(CM[,3:8], method = "spearman"), method= "pie") # variable de la 3 a la 8
########################
#
# Regresion Lineal
#
########################
modeloRT <- lm(CM_radio ~ CM_textura) # estimar el radio dado la textura
modeloRT
summary(modeloRT)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloRT)
####
modeloTR <- lm(CM_textura ~ CM_radio) # estimar la textura dado el radio
modeloTR
summary(modeloTR)
plot(CM_radio, CM_textura, pch=16, cex=1.3, col="red")
abline(modeloTR)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloRT)
##### Transformacion logaritmica #####
skewness(CM_textura)
hist(CM_textura)
modelo_logaritmico <- lm(log(CM_textura) ~ CM_radio)
hist(log(CM_textura))
shapiro.test(log(CM_textura))
summary(modelo_logaritmico)
summary(modeloRT)
summary(modelo_logaritmico)
plot(modelo_logaritmico)
### Transformacion con la raiz cuadrada ###### residuos no normales o heterolasticidad
modeloSQRT <- lm(sqrt(CM_textura) ~ CM_radio)
summary(modeloSQRT)
plot(modeloSQRT)
install.packages("MASS")
library(MASS)
boxcox(modeloRT)
# si esta cercano a cero se usa transformacion logaritmica
boxcox(modeloRT)
# si esta cercano a cero se usa transformacion logaritmica
# La transformación de Box-Cox viene dada por la siguiente fórmula:
# 1 no transformar
# 0.5 es raiz
# 0 log
# -0.5 invesro de la raiz 1/sqrt(x)
# -1 inverso (1/y)
b <- boxcox(modeloRT)
# Lambda exacto
lambda <- b$x[which.max(b$y)] # -0.02
lambda
############# Modelo Robusto ########### rlm
modeloRb <- rlm(CM_textura ~ CM_radio)
summary(modeloRb)
############# Modelo Robusto ########### rlm
modeloRB <- rlm(CM_textura ~ CM_radio)
summary(modeloRB)
plot(modmodeloRBplot(modeloRb)
plot(modeloRB)
############# Modelo Robusto ########### rlm
modeloRB <- rlm(CM_textura ~ CM_radio)
summary(modeloRB)
plot(modeloRB)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloRT)
abline(modeloRB)
abline(modeloRB, col="red", lty=3)
# Librerias
library(corrplot)
library(e1071)
# Conjunto de datos de cancer de mama CM (lesiones)
CM <- wdbc_unificado
# Funcion
plotn <- function(x,main="Histograma de frecuencias \ny distribución normal",
xlab="X",ylab="Densidad") {
min <- min(x)
max <- max(x)
media <- mean(x)
dt <- sd(x)
hist(x,freq=F,main=main,xlab=xlab,ylab=ylab)
curve(dnorm(x,media,dt), min, max,add = T,col="red") # Genera una curva de distribucion normal
}
CM <- wdbc_unificado
CM_radio <- CM$radius_mean
CM_textura <- CM$texture_mean
mean(CM_radio)
median(CM_radio)
boxplot(CM_radio)
sd(CM_radio) # 14.12 +- 3.52 -> {10.6, 17.64 (68%)}  {7 - 21 (95%)} {3.5 - 24.5 (99.7%)}
skewness(CM_radio)
kurtosis(CM_radio)
summary(CM_radio)
hist(CM_radio)
plotn(CM_radio)
shapiro.test(CM_radio [180:210])
ks.test(CM_radio, "pnorm", mean = mean(CM_radio), sd = sd(CM_radio))
qqnorm(CM_radio)
mean(CM_textura)
median(CM_textura)
boxplot(CM_textura)
summary(CM_textura)
sd(CM_textura) #19.29 +- 4.3 --- 15 - 23.6 (68%) 10.7 - 28 (95%) 6.4 - 32.3 (99.7%)
skewness(CM_textura)
kurtosis(CM_textura)
hist(CM_textura)
plotn(CM_textura)
shapiro.test(CM_radio [30:60])
ks.test(CM_textura, "pnorm", mean = mean(CM_textura), sd = sd(CM_textura))
qqnorm(CM_textura)
# Correlaciones
cor.test(CM_radio, CM_textura)
cor.test(CM_textura, CM_radio)
cor.test(CM_radio, CM_textura, method = "spearman")
corrplot(cor(CM[,3:8], method = "spearman"), method= "pie") # variable de la 3 a la 8
########################
#
# Regresion Lineal
#
########################
modeloRT <- lm(CM_radio ~ CM_textura) # estimar el radio dado la textura
modeloRT
summary(modeloRT)
plot(CM_textura, CM_radio, pch=16, cex=1.3, col="green")
abline(modeloRT)
#### otro modelo
modeloTR <- lm(CM_textura ~ CM_radio) # estimar la textura dado el radio
modeloTR
summary(modeloTR)
plot(CM_radio, CM_textura, pch=16, cex=1.3, col="red")
abline(modeloTR)
### Transformacion logaritmica ##### (arreglar la normalidad) sesgo o forma de U
skewness(CM_textura)
hist(CM_textura)
modelo_logaritmico <- lm(log(CM_textura) ~ CM_radio)
summary(modelo_logaritmico)
plot(modelo_logaritmico)
plot(modeloSQRT)
# La transformación de Box-Cox viene dada por la siguiente fórmula:
# 1 no transformar
# 0.5 es raiz
# 0 log
# -0.5 invesro de la raiz 1/sqrt(x)
# -1 inverso (1/y)
b <- boxcox(modeloRT)
install.packages("boxcoxmix")
library(boxcoxmix)
# si esta cercano a cero se usa transformacion logaritmica
# La transformación de Box-Cox viene dada por la siguiente fórmula:
# 1 no transformar
# 0.5 es raiz
# 0 log
# -0.5 invesro de la raiz 1/sqrt(x)
# -1 inverso (1/y)
b <- boxcox(modeloRT)
# paquete MASS: para saber la transformacion que mejor nos conviene (Box-Cox)
library(MASS)
# si esta cercano a cero se usa transformacion logaritmica
# La transformación de Box-Cox viene dada por la siguiente fórmula:
# 1 no transformar
# 0.5 es raiz
# 0 log
# -0.5 invesro de la raiz 1/sqrt(x)
# -1 inverso (1/y)
b <- boxcox(modeloRT)
install.packages("hclust1d")
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
library(hclust)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
library(hclust1d)
mdCancer <- dist(CM[,1:30])
View(CM)
hcCancer <- (mdCancer)
summary(hcCancer)
plot(hcCancer)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((CM[,1:30])) ## matriz de distancias (sin la variable de salida)
hcCancer <- (mdCancer)
summary(hcCancer)
plot(hcCancer)
hcCancer <- hclust(mdCancer)
summary(hcCancer)
plot(hcCancer)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((CM[1:100,1:30])) ## matriz de distancias (sin la variable de salida)
hcCancer <- hclust(mdCancer)
summary(hcCancer)
plot(hcCancer)
rect.hclust(hcCancer, K=2, border = "green")
rect.hclust(hcCancer, k=2, border = "green")
rect.hclust(hcCancer, k=2, border = "red")
rect.hclust(hcCancer, k=3, border = "red") ## ver los grupos
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
# Conjunto de datos de cancer de mama CM (lesiones)
CM <- wdbc_unificado
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
CM <- wdbc_unificado
CM_radio <- CM$radius_mean
CM_textura <- CM$texture_mean
mean(CM_radio)
median(CM_radio)
boxplot(CM_radio)
sd(CM_radio) # 14.12 +- 3.52 -> {10.6, 17.64 (68%)}  {7 - 21 (95%)} {3.5 - 24.5 (99.7%)}
skewness(CM_radio)
kurtosis(CM_radio)
summary(CM_radio)
hist(CM_radio)
plotn(CM_radio)
shapiro.test(CM_radio [180:210])
ks.test(CM_radio, "pnorm", mean = mean(CM_radio), sd = sd(CM_radio))
qqnorm(CM_radio)
### Transformacion logaritmica ##### (arreglar la normalidad) sesgo o forma de U
skewness(CM_textura)
hist(CM_textura)
modelo_logaritmico <- lm(log(CM_textura) ~ CM_radio)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
CM$Diagnosis <- as.factor(CM$Diagnosis)
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
View(CM)
View(CM)
malignos <- CM[CM&Diagnosis == 1,]
install.packages("ape")
library(ape)
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
CM$Diagnosis
######## Un enfoque no supervisado #####
### HC -> Clustering Jerárquico
CM$Diagnosis <- ifelse(CM$Diagnosis == "M", 1, 0)
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
hcCancer <- hclust(mdCancer)
mdCancer <- dist((log(CM[1:100,1:30]))) ## matriz de distancias (sin la variable de salida)
hcCancer <- hclust(mdCancer)
summary(hcCancer)
plot(hcCancer)
rect.hclust(hcCancer, k=2, border = "red") ## ver los grupos
malignos <- CM[CM&Diagnosis == 1,]
malignos <- CM[CM&Diagnosis == 1,]
colores <- c("red", "green", "blue", "magenta")
mdCancer <- dist((log(CM[1:50,1:30]))) ## matriz de distancias (sin la variable de salida)
hcCancer <- hclust(mdCancer)
summary(hcCancer)
plot(hcCancer)
rect.hclust(hcCancer, k=2, border = "red") ## ver los grupos
malignos <- CM[CM&Diagnosis == 1,]
malignos <- CM[CM$Diagnosis == 1,]
mdMalignos <- dist((malignos))
hcM <- hclust(mdMalignos)
dc <- CM[50:100]
malignos <- dc[dc$Diagnosis == 1,]
dc <- CM[50:100]
dc <- CM[50:100, ]
malignos <- dc[dc$Diagnosis == 1,]
mdMalignos <- dist((malignos))
hcM <- hclust(mdMalignos)
plot(hcM)
rect.hclust(hcM, k=4, border = "blue")
library(ape)
plot(as.phylo(hcM))
plot(as.phylo(hcM), type="fan")
colores <- c("red", "green", "blue", "magenta")
hcMc <- cutree(hcM, 4)
plot(as.phylo(hcM), type="fan", tip.color = colores[hcMc])
# Ejemplo con el dataset mtcars
mtcar
# Ejemplo con el dataset mtcars
mtcars
# matriz de distancias de los carros
mdcars <- dist(mtcars)
hcCars <- hclust(mdcars)
plot(hcCars)
rect.hclust(hcCars, k=4, border = "blue")
rect.hclust(hcCars, k=2, border = "blue")
rect.hclust(hcCars, k=4, border = "blue")
plot(hcCars)
rect.hclust(hcCars, k=4, border = "blue")
plot(hcCars)
rect.hclust(hcCars, k=3, border = "blue")
hcC <- cutree(hcCars, 3)
hcC
plot(as.phylo(hcCars), type="fan", tip.color = colores[hcC])
